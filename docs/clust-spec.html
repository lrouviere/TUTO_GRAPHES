<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Clustering spectral | Graph Mining</title>
  <meta name="description" content="Chapitre 4 Clustering spectral | Graph Mining" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Clustering spectral | Graph Mining" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Clustering spectral | Graph Mining" />
  
  
  

<meta name="author" content="Laurent Rouvière" />


<meta name="date" content="2021-11-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="commu-modul.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/vis-9.1.0/vis-network.min.css" rel="stylesheet" />
<script src="libs/vis-9.1.0/vis-network.min.js"></script>
<script src="libs/visNetwork-binding-2.1.0/visNetwork.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Graph Mining<br> <br> L. Rouvière</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Présentation</a></li>
<li class="chapter" data-level="1" data-path="manip-graphes.html"><a href="manip-graphes.html"><i class="fa fa-check"></i><b>1</b> Manipulation de graphes avec <code>igraph</code></a>
<ul>
<li class="chapter" data-level="1.1" data-path="manip-graphes.html"><a href="manip-graphes.html#construction-de-graphes-avec-igraph"><i class="fa fa-check"></i><b>1.1</b> Construction de graphes avec igraph</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="manip-graphes.html"><a href="manip-graphes.html#quelques-fonctions-r-pour-construire-des-graphes"><i class="fa fa-check"></i><b>1.1.1</b> Quelques fonctions R pour construire des graphes</a></li>
<li class="chapter" data-level="1.1.2" data-path="manip-graphes.html"><a href="manip-graphes.html#construction-à-partir-dun-fichier-externe"><i class="fa fa-check"></i><b>1.1.2</b> Construction à partir d’un fichier externe</a></li>
<li class="chapter" data-level="1.1.3" data-path="manip-graphes.html"><a href="manip-graphes.html#matrice-dadjacence"><i class="fa fa-check"></i><b>1.1.3</b> Matrice d’adjacence</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="manip-graphes.html"><a href="manip-graphes.html#visualisation-dun-graphe"><i class="fa fa-check"></i><b>1.2</b> Visualisation d’un graphe</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="manip-graphes.html"><a href="manip-graphes.html#network-layouts-algorithmes-usuels-de-visualisation"><i class="fa fa-check"></i><b>1.2.1</b> Network layouts : algorithmes usuels de visualisation</a></li>
<li class="chapter" data-level="1.2.2" data-path="manip-graphes.html"><a href="manip-graphes.html#personnalisation-du-graphe"><i class="fa fa-check"></i><b>1.2.2</b> Personnalisation du graphe</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="manip-graphes.html"><a href="manip-graphes.html#statistiques-descriptives-sur-les-graphes"><i class="fa fa-check"></i><b>1.3</b> Statistiques descriptives sur les graphes</a></li>
<li class="chapter" data-level="1.4" data-path="manip-graphes.html"><a href="manip-graphes.html#autres-packages-pour-visualiser-les-graphes"><i class="fa fa-check"></i><b>1.4</b> Autres packages pour visualiser les graphes</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="manip-graphes.html"><a href="manip-graphes.html#graphes-dynamiques-avec-visnetwork"><i class="fa fa-check"></i><b>1.4.1</b> Graphes dynamiques avec visNetwork</a></li>
<li class="chapter" data-level="1.4.2" data-path="manip-graphes.html"><a href="manip-graphes.html#graphes-ggplot-avec-ggnet"><i class="fa fa-check"></i><b>1.4.2</b> Graphes <strong>ggplot</strong> avec <strong>ggnet</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="model-const-graphes.html"><a href="model-const-graphes.html"><i class="fa fa-check"></i><b>2</b> Modèles et construction de graphes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="model-const-graphes.html"><a href="model-const-graphes.html#modèles-de-graphe"><i class="fa fa-check"></i><b>2.1</b> Modèles de graphe</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="model-const-graphes.html"><a href="model-const-graphes.html#graphe-derdos-renyi"><i class="fa fa-check"></i><b>2.1.1</b> Graphe d’Erdos-Renyi</a></li>
<li class="chapter" data-level="2.1.2" data-path="model-const-graphes.html"><a href="model-const-graphes.html#modèles-à-blocs-stochastiques"><i class="fa fa-check"></i><b>2.1.2</b> Modèles à blocs stochastiques</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="model-const-graphes.html"><a href="model-const-graphes.html#construire-un-graphe-à-partir-de-données-classiques"><i class="fa fa-check"></i><b>2.2</b> Construire un graphe à partir de données “classiques”</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="commu-modul.html"><a href="commu-modul.html"><i class="fa fa-check"></i><b>3</b> Détection de communautés : approche modularité</a></li>
<li class="chapter" data-level="4" data-path="clust-spec.html"><a href="clust-spec.html"><i class="fa fa-check"></i><b>4</b> Clustering spectral</a>
<ul>
<li class="chapter" data-level="4.1" data-path="clust-spec.html"><a href="clust-spec.html#clustering-spectral-sur-1-graphe-à-3-composantes-connexes"><i class="fa fa-check"></i><b>4.1</b> Clustering spectral sur 1 graphe à 3 composantes connexes</a></li>
<li class="chapter" data-level="4.2" data-path="clust-spec.html"><a href="clust-spec.html#programmer-le-clustering-spectral-pour-un-graphe"><i class="fa fa-check"></i><b>4.2</b> Programmer le clustering spectral pour un graphe</a></li>
<li class="chapter" data-level="4.3" data-path="clust-spec.html"><a href="clust-spec.html#exemple-sur-des-graphes-réels"><i class="fa fa-check"></i><b>4.3</b> Exemple sur des graphes “réels”</a></li>
<li class="chapter" data-level="4.4" data-path="clust-spec.html"><a href="clust-spec.html#clustering-spectral-cas-général"><i class="fa fa-check"></i><b>4.4</b> Clustering spectral : cas général</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Graph Mining</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="clust-spec" class="section level1" number="4">
<h1><span class="header-section-number">Chapitre 4</span> Clustering spectral</h1>
<p>Le <em>clustering spectral</em> est un algorithme de classification non supervisé qui permet de définir des clusters de nœuds sur des graphes ou d’individus pour des données <code>individus/variables</code>. L’algorithme est basé sur la décomposition spectrale du Laplacien (normalisé) d’une matrice de similarité, il est résumé ci-dessous :</p>

<div class="correction">
<p><strong>Entrées</strong> :</p>
<ul>
<li>tableau de données <span class="math inline">\(n\times p\)</span></li>
<li><span class="math inline">\(K\)</span> un noyau</li>
<li><span class="math inline">\(k\)</span> le nombre de clusters.</li>
</ul>
<ol style="list-style-type: decimal">
<li>Calculer la matrice de <strong>similarités <span class="math inline">\(W\)</span></strong> sur les données en utilisant le <strong>noyau <span class="math inline">\(K\)</span></strong></li>
<li>Calculer le <strong>Laplacien normalisé</strong> <span class="math inline">\(L_{\text{norm}}\)</span> à partir de <span class="math inline">\(W\)</span>.</li>
<li>Calculer les <strong><span class="math inline">\(k\)</span> premiers vecteurs propres</strong> <span class="math inline">\(u_1,\dots,u_k\)</span> de <span class="math inline">\(L_{\text{norm}}\)</span>. On note <span class="math inline">\(U\)</span> la matrice <span class="math inline">\(n\times k\)</span> qui les contient.</li>
<li>Calculer la matrice <span class="math inline">\(T\)</span> en <strong>normalisant les lignes</strong> de <span class="math inline">\(U\)</span> : <span class="math inline">\(t_{ij}=u_{ij}/(\sum_\ell u_{i\ell}^2)^{1/2}\)</span>.</li>
<li>Faire un <strong><span class="math inline">\(k\)</span>-means</strong> avec les points <span class="math inline">\(y_i,i=1,\dots,n\)</span> (i-<span class="math inline">\(ème\)</span> ligne de <span class="math inline">\(T\)</span>) <span class="math inline">\(\Longrightarrow\)</span> <span class="math inline">\(A_1,\dots,A_k\)</span>.</li>
</ol>
<strong>Sortie</strong> : clusters <span class="math inline">\(C_1,\dots,C_k\)</span> avec
<span class="math display">\[C_j=\{i|y_i\in A_j\}.\]</span>
</div>
<p>L’objet de ce chapitre est de travailler sur cet algorithme en le programmant, puis en utilisant la fonction <strong>specc</strong> du package <code>kernlab</code>.</p>
<div id="clustering-spectral-sur-1-graphe-à-3-composantes-connexes" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Clustering spectral sur 1 graphe à 3 composantes connexes</h2>
<p>On crée tout d’abord un graphe avec trois composantes connexes : on utilise la commande <strong>sample_gnp()</strong> qui permet de créer un graphe selon le modèle d’Erdos-Renyi.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="clust-spec.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb47-2"><a href="clust-spec.html#cb47-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb47-3"><a href="clust-spec.html#cb47-3" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb47-4"><a href="clust-spec.html#cb47-4" aria-hidden="true" tabindex="-1"></a>n3 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-5"><a href="clust-spec.html#cb47-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n1<span class="sc">+</span>n2<span class="sc">+</span>n3</span>
<span id="cb47-6"><a href="clust-spec.html#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="co"># il faut prendre des grandes valeurs de p sinon on risque d&#39;avoir des sous-graphes non connexes </span></span>
<span id="cb47-7"><a href="clust-spec.html#cb47-7" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.85</span></span>
<span id="cb47-8"><a href="clust-spec.html#cb47-8" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb47-9"><a href="clust-spec.html#cb47-9" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb47-10"><a href="clust-spec.html#cb47-10" aria-hidden="true" tabindex="-1"></a>G1 <span class="ot">&lt;-</span> <span class="fu">sample_gnp</span>(n1,p1)</span>
<span id="cb47-11"><a href="clust-spec.html#cb47-11" aria-hidden="true" tabindex="-1"></a>G2 <span class="ot">&lt;-</span> <span class="fu">sample_gnp</span>(n2,p2)</span>
<span id="cb47-12"><a href="clust-spec.html#cb47-12" aria-hidden="true" tabindex="-1"></a>G3 <span class="ot">&lt;-</span> <span class="fu">sample_gnp</span>(n3,p3)</span>
<span id="cb47-13"><a href="clust-spec.html#cb47-13" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> G1 <span class="sc">+</span> G2 <span class="sc">+</span> G3 <span class="co"># il cree un graphe avec ces 3 sous-graphes</span></span>
<span id="cb47-14"><a href="clust-spec.html#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G)</span></code></pre></div>
<p><img src="TUTU_GRAPHES_files/figure-html/unnamed-chunk-184-1.png" width="672" style="display: block; margin: auto;" />
On vérifie le nombre de composantes connexes</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="clust-spec.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">components</span>(G)<span class="sc">$</span>no</span>
<span id="cb48-2"><a href="clust-spec.html#cb48-2" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">3</span></span></code></pre></div>
<div class="exercise">
<ol style="list-style-type: decimal">
<li></li>
<li><p>Calculer la matrice d’adjacence de <strong>G</strong> et en déduire le Laplacien non normalisé.</p></li>
<li><p>Retrouver ce Laplacien avec la fonction <strong>laplacian_matrix</strong>.</p></li>
<li><p>Calculer les valeurs propres et représenter les sur un graphe. Que remarquez-vous ?</p></li>
<li><p>Obtenir les trois vecteurs propres associés à la valeur propre nulle. Commenter.</p></li>
<li><p>Terminer l’algorithme de clustering spectral avec l’étape de <span class="math inline">\(k\)</span> means.</p></li>
<li><p>Visualiser les clusters.</p></li>
</ol>
ffalse{-91-76-97-112-108-97-99-105-101-110-32-110-111-114-109-97-108-105-115-233-93-}
<div class="exercise">
<span id="exr:exo-laplacien-norm" class="exercise"><strong>Exercice 4.1  \iffalse (Laplacien normalisé)  </strong></span>
</div>
<p>Refaire le même travail en utilisant le laplacien normalisé. On n’oubliera pas d’ajouter l’étape de normalisation en utilisant par exemple la fonction suivante :</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="clust-spec.html#cb49-1" aria-hidden="true" tabindex="-1"></a>normalize <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb49-2"><a href="clust-spec.html#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))) </span>
<span id="cb49-3"><a href="clust-spec.html#cb49-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="programmer-le-clustering-spectral-pour-un-graphe" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Programmer le clustering spectral pour un graphe</h2>
<div class="exercise">
<p><span id="exr:exo-prog-clust-spec" class="exercise"><strong>Exercice 4.2  (Construction de l'algorithme) </strong></span>Créer une fonction <strong>R</strong> qui admet en entrée :</p>
<ul>
<li>un graphe</li>
<li>une valeur de <span class="math inline">\(K\)</span> (un entier positif)</li>
</ul>
<p>et qui renvoie les groupes pour le clustering spectral à <span class="math inline">\(K\)</span> groupes ainsi que le graphe des valeurs propres (en <strong>ggplot</strong> si possible).</p>
<p>Igraph possède une fonction permettant de faire directement le spectral clustering : <strong>embed_laplacian_matrix</strong>. Mais en argument, il faut lui donner le nombre <span class="math inline">\(K\)</span> de clusters souhaité. En pratique, on ne connait pas <span class="math inline">\(K\)</span>, et une façon de le trouver est de regarder le trou spectral dans le graphe des valeurs propres.</p>
<p>La fonction <strong>embed_laplacian_matrix</strong> s’utilise ainsi :</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="clust-spec.html#cb50-1" aria-hidden="true" tabindex="-1"></a>res2 <span class="ot">&lt;-</span> <span class="fu">embed_laplacian_matrix</span>(G,<span class="dv">8</span>,<span class="at">which=</span><span class="st">&quot;sa&quot;</span>,<span class="at">scaled=</span><span class="st">&quot;FALSE&quot;</span>,<span class="at">degmode =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb50-2"><a href="clust-spec.html#cb50-2" aria-hidden="true" tabindex="-1"></a>res2<span class="sc">$</span>D</span>
<span id="cb50-3"><a href="clust-spec.html#cb50-3" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span></span></code></pre></div>
<p>On peut faire du clustering spectral à 3 groupes avec :</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="clust-spec.html#cb51-1" aria-hidden="true" tabindex="-1"></a>res3 <span class="ot">&lt;-</span> <span class="fu">embed_laplacian_matrix</span>(G,<span class="dv">3</span>,<span class="at">which=</span><span class="st">&quot;sa&quot;</span>,<span class="at">scaled=</span><span class="st">&quot;FALSE&quot;</span>,<span class="at">degmode =</span> <span class="st">&quot;all&quot;</span>)</span>
<span id="cb51-2"><a href="clust-spec.html#cb51-2" aria-hidden="true" tabindex="-1"></a>res_spectral <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(res3<span class="sc">$</span>X, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">100</span>)</span>
<span id="cb51-3"><a href="clust-spec.html#cb51-3" aria-hidden="true" tabindex="-1"></a>res_spectral<span class="sc">$</span>cluster</span>
<span id="cb51-4"><a href="clust-spec.html#cb51-4" aria-hidden="true" tabindex="-1"></a> [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span></span></code></pre></div>
</div>
<div class="exercise">
<p><span id="exr:exo-spec-deux-commu" class="exercise"><strong>Exercice 4.3  (Graphe avec deux communautés faiblement connectées entre elles) </strong></span>On considère le graphe suivant obtenu selon un modèle <strong>SBM</strong> :</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="clust-spec.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb52-2"><a href="clust-spec.html#cb52-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span><span class="co"># nombre de noeuds</span></span>
<span id="cb52-3"><a href="clust-spec.html#cb52-3" aria-hidden="true" tabindex="-1"></a>Q <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># nombre de cluster clusters</span></span>
<span id="cb52-4"><a href="clust-spec.html#cb52-4" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>) <span class="co"># taille des groupes  </span></span>
<span id="cb52-5"><a href="clust-spec.html#cb52-5" aria-hidden="true" tabindex="-1"></a>effectifs <span class="ot">&lt;-</span> n<span class="sc">*</span>pi</span>
<span id="cb52-6"><a href="clust-spec.html#cb52-6" aria-hidden="true" tabindex="-1"></a>connectivite_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.15</span>,</span>
<span id="cb52-7"><a href="clust-spec.html#cb52-7" aria-hidden="true" tabindex="-1"></a>                                <span class="fl">0.15</span>, <span class="fl">0.95</span>),<span class="at">nrow=</span>Q) <span class="co"># matrice de connexion</span></span>
<span id="cb52-8"><a href="clust-spec.html#cb52-8" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="fu">sample_sbm</span>(n, <span class="at">pref.matrix=</span>connectivite_matrix, <span class="at">block.sizes =</span> effectifs)</span>
<span id="cb52-9"><a href="clust-spec.html#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G)</span></code></pre></div>
<p><img src="TUTU_GRAPHES_files/figure-html/unnamed-chunk-217-1.png" width="672" style="display: block; margin: auto;" />
Effectuer le clustering spectral sur ce graphe, on essaiera notamment de choisir le nombre de groupes.</p>
</div>
</div>
<div id="exemple-sur-des-graphes-réels" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Exemple sur des graphes “réels”</h2>
<div class="exercise">
<ol style="list-style-type: decimal">
<li></li>
<li><p>On considère le graphe <strong>friends</strong> disponible <a href="http://www.sociopatterns.org/datasets/high-school-contact-and-friendship-networks/">ici</a></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="clust-spec.html#cb53-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">file=</span><span class="st">&quot;data/Friendship-network_data_2013.csv&quot;</span>)</span>
<span id="cb53-2"><a href="clust-spec.html#cb53-2" aria-hidden="true" tabindex="-1"></a>G.friends <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(friends,<span class="at">directed=</span>F)  <span class="co"># non dirige</span></span>
<span id="cb53-3"><a href="clust-spec.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G.friends)</span></code></pre></div>
<p><img src="TUTU_GRAPHES_files/figure-html/unnamed-chunk-225-1.png" width="672" style="display: block; margin: auto;" />
Appliquer le clustering spectral à ce graphe. On pourra comparer la classification obtenue avec celle de la méthode de Louvain en utilisant la fonction <strong>compare</strong>.</p></li>
<li><p>Faire de même avec le graphe <strong>karate</strong>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="clust-spec.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraphdata)</span>
<span id="cb54-2"><a href="clust-spec.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(karate)</span></code></pre></div></li>
</ol>
</div>
</div>
<div id="clustering-spectral-cas-général" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Clustering spectral : cas général</h2>
<p>Nous avons étudié jusqu’ici l’algorithme du clustering spectral pour trouver des clusters de nœuds (ou communautés) dans les graphes. On remarque néanmoins que l’algorithme ne repose pas sur le graphe en lui même, mais uniquement sur une matrice d’adjacence (ou similarité) issue de ce graphe. Il est par conséquent possible d’utiliser cet algorithme pour des données standards (tableaux <code>individus-variables</code>), à partir du moment où on peut calculer une matrice de similarité à partir de ces données. Il est également possible d’utiliser des <strong>noyaux</strong> pour définir cette similarité. La fonction <strong>specc</strong> de <code>kernlab</code> permet de faire un tel clustering.</p>
<div class="exercise">
<p><span id="exr:exo-spec-spirales" class="exercise"><strong>Exercice 4.4  (Clustering spectral pour des psirales) </strong></span>On considère les données spirales</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="clust-spec.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb55-2"><a href="clust-spec.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlbench)</span>
<span id="cb55-3"><a href="clust-spec.html#cb55-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb55-4"><a href="clust-spec.html#cb55-4" aria-hidden="true" tabindex="-1"></a>simu <span class="ot">&lt;-</span> <span class="fu">mlbench.spirals</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="fl">0.025</span>)  </span>
<span id="cb55-5"><a href="clust-spec.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(simu)</span>
<span id="cb55-6"><a href="clust-spec.html#cb55-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] <span class="st">&quot;x&quot;</span>       <span class="st">&quot;classes&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="clust-spec.html#cb56-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> simu<span class="sc">$</span>x</span>
<span id="cb56-2"><a href="clust-spec.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb56-3"><a href="clust-spec.html#cb56-3" aria-hidden="true" tabindex="-1"></a>           [,<span class="dv">1</span>]        [,<span class="dv">2</span>]</span>
<span id="cb56-4"><a href="clust-spec.html#cb56-4" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>,]  <span class="fl">0.5609898</span> <span class="sc">-</span><span class="fl">0.21756239</span></span>
<span id="cb56-5"><a href="clust-spec.html#cb56-5" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>,]  <span class="fl">0.2793522</span>  <span class="fl">0.01718273</span></span>
<span id="cb56-6"><a href="clust-spec.html#cb56-6" aria-hidden="true" tabindex="-1"></a>[<span class="dv">3</span>,]  <span class="fl">0.3725821</span>  <span class="fl">0.03849122</span></span>
<span id="cb56-7"><a href="clust-spec.html#cb56-7" aria-hidden="true" tabindex="-1"></a>[<span class="dv">4</span>,]  <span class="fl">0.3457879</span>  <span class="fl">0.08963081</span></span>
<span id="cb56-8"><a href="clust-spec.html#cb56-8" aria-hidden="true" tabindex="-1"></a>[<span class="dv">5</span>,]  <span class="fl">0.1577921</span>  <span class="fl">0.81528541</span></span>
<span id="cb56-9"><a href="clust-spec.html#cb56-9" aria-hidden="true" tabindex="-1"></a>[<span class="dv">6</span>,] <span class="sc">-</span><span class="fl">0.1603697</span>  <span class="fl">0.84547763</span></span></code></pre></div>
<p>et on les visualise.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="clust-spec.html#cb57-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(simu<span class="sc">$</span>x)</span>
<span id="cb57-2"><a href="clust-spec.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X1,<span class="at">y=</span>X2)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="TUTU_GRAPHES_files/figure-html/unnamed-chunk-241-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Appliquer les algorithmes suivants pour tenter de visualiser les deux groupes :</p>
<ul>
<li>clustering spectral avec noyau linéaire</li>
<li>clustering spectral avec noyau polynomial de degree 2</li>
<li>clustering spectral avec noyau radial</li>
<li><span class="math inline">\(k\)</span>-means</li>
<li>CAH avec single linkage</li>
<li>CAH avec lien de Ward</li>
</ul>
</div>

<!---

# Références {-}

--->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="commu-modul.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["TUTU_GRAPHES.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"sharing": {
"facebook": true,
"github": true,
"twitter": true
}
},
"highlight": "tango"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
